<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
    #it{
        width: 40px;
    }
    #mydiv{
        height: 170px;
    }
</style>
</head>
<body>
<table border="1px">
    <tr>
        <td>맞출 수</td>
        <td>
            <input type="text" id="it">
        </td>
    </tr>
    <tr>
        <td colspan="2">
            <input type="button" onclick="myclick()" value="맞춰보기">
        </td>
    </tr>
    <tr>
        <td colspan="2">
            <div id="mydiv"></div>
        </td>
    </tr>
</table>
<script>
    // 1~ 9의 수 중에서 중복 없이 3개 선택
    // com = 123
    // my = 321 일 때
    // 자리수가 같으면 strike, 자리수가 다르면 ball -> 1S2B
    // 오답 누적 출력하여 정답 유도하기
    // 3 strike 나오면 정답 처리 -> alert (정답숫자+축하합니다!)
    let coms = [];
    let mine = [];
    let mydiv = document.getElementById("mydiv");
    console.log(mydiv);
    let comNum = 0;
    window.onload = () => {
            generateComs();
            mydiv.innerHTML = '';
    }

    function generateComs() {

        /*
        let com = "123";
        야바위법으로 숫자생성
        let arr9 = [1,2,3,4,5,6,7,8,9];
        for(let i=0; i<1000; i++){
            let rnd = partInt(Math.random()*9);
            let temp = arr9[0];
            arr9[0] = arr9[rnd];
            arr9[rnd] = temp;
        }

        com = arr9[0] + "" + arr9[1] + "" + arr9[2];
         */

        const nums = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
        let firstNum = Math.floor(Math.random() * 9) + 1;
        console.log(firstNum);
        coms.push(nums[firstNum].toString());
        console.log(coms);
        nums.splice(firstNum, 1);
        console.log("1번째 자리 숫자 추가 후 nums",nums);

        for(let i = 0; i < 2; i++) {
            let index = Math.floor(Math.random() * nums.length);
            console.log(index);
            coms.push(nums[index].toString());
            nums.splice(index, 1);
            console.log(`${i+2}번째 자리 숫자 추가 후 nums ${nums}`);
        }
        console.log("완전체 coms",coms);
        comNum = coms.join('');
        console.log(comNum);
    }

    function myclick() {
        let my = document.getElementById("it");
        console.log("my",my);

        let myVal = my.value.trim();
        console.log("myVal",myVal);

        mine = myVal.split('');
        console.log("mine",mine);

        if(isNaN(Number(myVal)) || myVal.length !== 3 ) {
            alert(" 정수 3자리만 입력 가능");
            my.value= "";
            my.focus();
            return;
        }
        let uniqueTest = new Set(mine);
        for(let i = 0; i < 2; i++) {
            if(uniqueTest.size !== 3) {
                alert("같은 숫자 입력 불가능");
                my.value= "";
                my.focus();
                return;
            }
        }
        result();
        my.value= "";
        my.focus();
    }


    function result() {
        let strike = 0;
        let ball = 0;
        for(let i = 0; i < 3; i++) {
            if(coms[i] === mine[i]) {
                strike ++;
            }
        }

        for(let i = 0; i < 3; i++) {
            if(coms[i] !== mine[i] ) {
                ball ++;
            }
        }

        if(strike ===  3) {
            setTimeout(() => {
            alert(`${comNum} 정답입니다!`);
            }, 1000);
        }
        myNum = mine.join('');
        mydiv.innerHTML += `${myNum} ${strike}S ${ball}B<br>`;
    }

</script>
</body>
</html>